YUI.add("gallery-yui3treeview-ng-datasource",function(h){var b=h.ClassNameManager.getClassName,c="contentBox",e="boundingBox",a="treeviewdatasource",f="treenode",g={loading:b(f,"loading")};function d(){d.superclass.constructor.apply(this,arguments);}d.NAME=a;d.NS="ds";d.ATTRS={source:{value:null},loadingMsg:{value:null},dataSchemaJSON:{value:{resultListLocator:null,resultFields:null,metaFields:null}},sourceMethod:{value:null,setter:function(j){var i=h.Attribute.INVALID_VALUE;if(["io","get","local"].indexOf(j)>=0){i=j;}return i;}}};h.extend(d,h.Plugin.Base,{initializer:function(){var j=this.get("sourceMethod"),i=this.get("dataSchemaJSON");this.publish("sendRequest",{defaultFn:this._makeRequest});this.publish("onDataReturnSuccess",{defaultFn:this._defSuccessHandler});this.publish("onDataReturnFailure",{defaultFn:this._defFailureHandler});switch(j){case"io":this.treedatasource=new h.DataSource.IO({source:this.get("source")});break;case"get":this.treedatasource=new h.DataSource.Get({source:this.get("source")});break;case"local":this.treedatasource=new h.DataSource.Local({source:this.get("source")});break;}this.treedatasource.plug(h.Plugin.DataSourceJSONSchema,{schema:{resultListLocator:i.resultListLocator,resultFields:i.resultFields}});},load:function(j,i){this.fire("sendRequest",{treenode:j,reuest:i});},_defSuccessHandler:function(j){var i=j.treenode;i.get(c).removeClass(g.loading);if(i._loadingMsgNode!==null){i._loadingMsgNode.remove(true);}i.add(j.response.results);if(i instanceof h.CheckBoxTreeNode){i._syncChildren();}this.get("host").get(e).focusManager.refresh();},_defFailureHandler:function(j){var i=j.treenode;i.set("loadOnDemand",true);i.get(c).removeClass(g.loading);},_makeRequest:function(n){var i=n.treenode,k=i.get("loadOnDemand"),m=this.get("loadingMsg"),l=n.request,j=i.get(c),o;if(!k){return;}o={success:h.bind(function(p){this.fire("onDataReturnSuccess",{response:p.response,treenode:i});},this),failure:h.bind(function(p){this.fire("onDataReturnFailure",{error:p.error,treenode:i});},this)};i.set("loadOnDemand",false);i.removeAll();j.addClass(g.loading);if(m){i._loadingMsgNode=j.appendChild(m);}this.treedatasource.sendRequest({request:"?"+l,callback:o});}});h.Plugin.TreeViewDataSource=d;},"@VERSION@",{requires:["gallery-yui3treeview-ng","plugin","datasource","datasource-jsonschema"],skinnable:false});